{% extends "base.html" %}

{% block content %}
  <h1>User profile: {{ user.username }}</h1>
  {% if user.bio %}<p>{{ user.bio }}</p>{% endif %}
  {% if user.last_seen %}<p>Last seen on:{{ user.last_seen }}</p>{% endif %}
  <hr>
  {% if user.open %}
  <p>Requests are open! </p>
  {% else %}
  <p>Requests are closed! </p>
  {% endif %}

  {% if current_user.username == user.username %}
  <p><a id="edit-profile" href="{{ url_for('main.edit_profile') }}">Edit your profile</a></p>
  <p>
    <hr>
    Your Jobs: <br>
    {% for request in requests %}
    {% if request.artist %}
    {% if request.artist.username == user.username and request.complete == False%}
    <a href="{{ url_for('main.user', username=request.author.username) }}">{{ request.author.username }}</a> says: 
    <b><a href="{{ url_for('main.requests', request_id=request.request_id) }}">{{ request.body }}</a></b> <br> 
    {% endif %}
    {% endif %}
  </p>
  {% endfor %}
  {% endif %}
  <hr>
  {% for request in requests %}
  <p>
    {% if request.author.username == user.username %}
    Requests: <br>
    {{ request.author.username }} says: 
    <b><a href="{{ url_for('main.requests', request_id=request.request_id) }}">{{ request.body }}</a></b> <br> 
    {% if request.artist %}
    artist: <a href="{{ url_for('main.user', username=request.artist.username) }}">{{ request.artist.username }}</a> <br>
    {% else %}
    artist: Open to all!
    {% endif %}
    {% endif %}
  </p>
  {% endfor %}
  <hr>
  {% for reply in replies %}
  <p>
    {% if reply.artist.username == user.username %}
    Reply to: <a href="{{ url_for('main.requests', request_id=reply.parent.request_id) }}">{{ reply.parent.body }}</a><br> 
    {{ reply.artist.username }} says: 
    <b>{{ reply.body }}</b> <br> 
    <img src="{{ url_for('static', filename=reply.body) }}" alt="local image">
    {% endif %}
  </p>
  {% endfor %}
  <hr>
{% endblock %}